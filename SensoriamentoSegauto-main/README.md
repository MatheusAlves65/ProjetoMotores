# SensoriamentoSegauto
Timers 1/2/4 estÃ£o sendo utilizados para controle pwm das ponte h.
Timer 5 usado pelo PWM nos pinos 44/46
Utilizando da biblioteca Timer interrupt se cria 2 ISR interrupt timer utilizando-se apenas do timer5, Erro encontrado foi de +-1ms.
Configurado igual agora Ã© capaz de fazer intervalos de 10ms Ã  10s com exatidÃ£o de 1ms.

# ðŸ“Š **RESUMO VISUAL DO FLUXO**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           INICIALIZAÃ‡ÃƒO                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ setup()                                                               â”‚
â”‚  â”œâ”€ Configura pinos (8 relÃ©s, PWM, motores)                          â”‚
â”‚  â”œâ”€ Inicializa Serial (115200 baud)                                  â”‚
â”‚  â”œâ”€ Inicializa Timers 3 e 5                                          â”‚
â”‚  â”œâ”€ Inicializa CAN (500kbps, cristal 8MHz)                           â”‚
â”‚  â””â”€ Carrega configs da EEPROM                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         LOOP PRINCIPAL                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TIMEOUT TEMPERATURA â”‚                  â”‚ PROCESSAR MENSAGEM   â”‚
â”‚ (500ms sem mensagem)â”‚                  â”‚ CAN RECEBIDA         â”‚
â”‚                     â”‚                  â”‚                      â”‚
â”‚ â€¢ ForÃ§a filtro com  â”‚                  â”‚ â€¢ 0x243 â†’ Reset      â”‚
â”‚   Ãºltimo valor      â”‚                  â”‚ â€¢ 0x401 â†’ Heartbeat  â”‚
â”‚ â€¢ SeguranÃ§a contra  â”‚                  â”‚ â€¢ 0x402 â†’ Digitais   â”‚
â”‚   falha de sensor   â”‚                  â”‚ â€¢ 0x403 â†’ Config Tempâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â€¢ 0x404 â†’ Config Aq. â”‚
                                         â”‚ â€¢ 0x405 â†’ Start/Stop â”‚
                                         â”‚ â€¢ 0x510 â†’ Temp Data  â”‚
                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AQUISIÃ‡ÃƒO PERIÃ“DICA â”‚                  â”‚ MONITORA TEMPERATURA â”‚
â”‚                     â”‚                  â”‚                      â”‚
â”‚ Se tempo >= timer:  â”‚                  â”‚ Sensor 1:            â”‚
â”‚ â€¢ Envia 8 remotes   â”‚                  â”‚ â€¢ temp1f >= max?     â”‚
â”‚ â€¢ LÃª respostas      â”‚                  â”‚   â†’ Inicia Timer5    â”‚
â”‚ â€¢ Envia 0x426       â”‚                  â”‚ â€¢ temp1f < max?      â”‚
â”‚   (pressÃ£o+vÃ¡lvula) â”‚                  â”‚   â†’ Cancela Timer5   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚                      â”‚
                                         â”‚ Sensor 2:            â”‚
                                         â”‚ â€¢ temp2f >= max?     â”‚
                                         â”‚   â†’ Inicia Timer3    â”‚
                                         â”‚ â€¢ temp2f < max?      â”‚
                                         â”‚   â†’ Cancela Timer3   â”‚
                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CONTROLA MOTOR      â”‚                  â”‚ LIMPA rxId           â”‚
â”‚                     â”‚                  â”‚                      â”‚
â”‚ setMotor(dir,pwm)   â”‚                  â”‚ rxId = 0             â”‚
â”‚ âš ï¸ Sempre parado!   â”‚                  â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ VOLTA AO INÃCIO â”‚
                    â”‚ DO LOOP         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
